---
title: "[SLAM] 로보틱스 확률 이론"
date: 2025-01-22 22:46:00 +09:00
categories: SLAM
description: 로보틱스에서 자주 사용되는 확률 이론에 대해 공부한다.
pin: true
use_math: true
---

## 1. 불확실성(Uncertainty)

로봇은 다양한 센서를 통해 주변 환경을 인식한다. 하지만 주변 온도, 빛 등에 따라 센서 값이 노이즈를 가지거나 잘못된 값을 가질 수 있다. 
작은 노이즈들이 쌓여 잘못된 환경을 제공할 수도 있다. 
또한 사람과 같이 동적으로 변화하는 환경 요소처럼 로봇이 변화를 실시간으로 반영하기 어려운 경우, 환경에 대한 예측이 불확실해진다. 
이처럼 로봇의 상태는 불확실성을 가진다. 

로봇에 미치는 불확실성은 외부 요인뿐만 아니라 로봇 내부 요인도 있다. 
예를 들어, 로봇의 액추에이터는 그 출력이 항상 명령어와 완벽히 일치하는 것은 아니다. 
바퀴의 미끄러짐이나 주변 환경에서의 진동, 하중, 온도 등으로 인하여 약간의 오차가 발생할 수 있다.

이와 같이 로봇은 구조화되지 않은 환경에서 작동하는 장치이기 때문에 이 불확실성을 반영하기 위해 결정론적인 접근법(deterministic) 보다는 확률론적인 접근법(probabilisitic)을 사용하는 것이 필요하다. 

## 2. 확률 변수(Random Variable)

확률 변수는 특정 실험에 대한 발생 가능한 모든 결과를 포함하는 변수이다. 예를 들어, 주사위 굴리기의 경우, 확률 변수는 주사위를 던져 나올 수 있는 숫자를 값으로 가질 수 있다. 또한 각 값에 대해 확률을 부여할 수 있는데 이를 아래와 같이 표현한다.

$$
P(X=1) = \frac{1}{6}
$$

확률은 0과 1사이의 값을 가지며, 확률 변수가 가질 수 있는 모든 값들에 대한 확률의 합은 1이다. 

### 2-1. 독립(Independent)

주사위 굴리기와 동전 던지기를 동시에 진행한다고 하자. 우리는 주사위의 결과값이 동전의 결과에 영향을 주지 않는 것을 알고 있다. 
이처럼 독립은 두 사건이 서로 영향을 미치지 않는 경우를 말한다. 이 경우 두 사건의 확률은 곱으로 계산할 수 있다.

$$
\begin{align*}
&P(X=3) = \frac{1}{6}  \\
&P(Y=tail) = \frac{1}{2}  \\
& \therefore P(X=3\;\cap\;Y=tail) = \frac{1}{6} \times \frac{1}{2} = \frac{1}{12}
\end{align*}
$$

### 2-2. 종속(Dependent)

하지만 만약 두 사건이 종속적이라면 두 사건의 확률은 어떻게 계산할 수 있을까?

예를 들어, 로봇이 어느 복도를 달리고 있다고 하자. 그리고 로봇의 센서를 통해 주변에 문이 있는지를 인식할 수 있다.

처음으로 문이 인식되면 로봇의 자신의 위치에 대해 가능성이 높은 A, B, C에 공평하게 확률을 부여한다. 

<img src="{{ site.baseurl }}/assets/img/post/SLAM/probability.png" alt="로봇 확률1" style="width: 100%">

이때 세 위치에 대한 확률은 서로 종속적인 관계를 가진다. 왜냐하면 로봇이 하나의 위치로 정해지면 다른 위치의 확률은 줄어들어야 하기 때문이다. 

그리고 잠시 후, 로봇은 또 다른 문을 하나 더 인식한다. 만약 이전의 로봇 위치가 B나 C였다면 이동한 지금, 문은 인식되어선 안된다. 따라서 로봇의 자신의 위치가 B임을 좀 더 확신하게 되고 현재 위치에 대한 B의 확률이 높아진다. 

<img src="{{ site.baseurl }}/assets/img/post/SLAM/probability2.png" alt="로봇 확률2" style="width: 100%">

이처럼 하나의 사건(문 인식)은 다른 사건(로봇의 위치)에 대한 결과를 유추할 수 있는 종속적인 관계를 지닌다. 

문 인식은 X, 로봇에 위치에 대한 확률을 Y라고 하면, 문이 인식되었을 때 로봇의 위치에 대한 확률은 아래 식과 같이 구할 수 있다. 

$$
P(Y|X) = \frac{P(X \cap Y)}{P(X)}
$$

## 3. 확률 분포(Probabilistic Distribution)

특정 사건이 발생할 확률의 분포를 나타내는 함수를 확률 분포라고 한다. 주사위 굴리기의 경우에는 6개의 결과가 모두 동일한 확률을 가지기 때문에 아래와 같은 확률 분포를 가진다. 

<img src="{{ site.baseurl }}/assets/img/post/SLAM/distribution.png" alt="주사위 확률분포" style="width: 100%">

이와 같이 모든 확률 변수 값에 대해 균일한 분포를 uniform distribution이라 하며, 이는 로봇에서 정보가 없는 초기상태의 확률 분포로 사용되기도 한다.
만약 주사위 굴리기와 동전 던지기의 합에 대한 확률 분포를 구한다면, 다른 형태의 분포가 작성될 것이다. 

확률 분포에서 계산 가능한 값은 평균(기대값), 표준편차, 분산이 있다. 평균은 확률 변수 값 중 가장 가능성이 있는 결과 값을 의미하고, 표준 편차와 분산은 확률 분포의 값이 평균에서 얼마나 퍼저있는지를 설명한다.

- 평균 : $E(X) = \mu = \sum x_iP(X=x_i)$
- 표준편차 : $\sigma$ 
- 분산 : $V(X) = \sigma^2 = \sum (x_i - \mu)^2 P(X=x_i) $

### 3-1. 가우시안 분포(Gaussian Distribution)

가우시안 분포는 정규분포(normal distribution)라고도 불리며 평균을 중심으로 
표준 편차가 크면 분포 값이 평균과 멀리 있음(확률 변수 취할 수 있는 값의 범위가 매우 넓음) = 불확실성이 있음
가우시안은 분포가 평균에 대해 대칭

f(X) = 1/sigma loot(2pi) e^(-1/2(x-mu/sigma)^2)
평균과 표준편차만으로 가우시안 분포의 형태를 앎
확률분포는 확률을 나타내는 곡선 = 합이 1 => 적분이 1

다른 확률 분포끼리 결합하거나 조작하는 것이 편리
녹색이 불확실성이 더 낮은 확률 분포

확률이 서로 종속적일 때, total probability theorem 을 사용 가능

실제 로봇의 B와 같이 공원 어디든 존재 가능 -> 센서에 인식된 물체에 따라 위치를 구분. 하지만 로봇이 길 위 A에 있다고 가정

P(A) = p(b1 교 A) + P(B2 교 A) + P(B3 교 A) = P(A|B)P(B) + ...

베이즈 정리 => 새로운 지식을 얻은 후 특정 이벤트의 확률을 어떻게 업데이트하는지에 대한 정리
새로운 정보를 얻은 후의 특정 이벤트에 대한 확률

초기 5m에 대해 불확실성. 로봇이 이동하고 새로운 나무에 대해 센싱햇을 떄, 이 정보를 사용하여 로봇의 추정을 개선(2m)

편향 정리(bias theorem) 은 새 정보후 확률 업데이트에 대한 수학 방정식
집합 이론과 조건부 확률

P(A 교 B) = P(B 교 A) => P(A|b)P(B) = P(B|A)P(A)
P(A|B) = P(B|A)P(A) / P(B)
Posterior probability = likelihood() Prior(초기 추측) / marginal(사건을 관찰할 수 있는 전체 확률)

새로운 증거를 기반으로 특정 이벤트 확률 업데이트

실제 환경의 센서는 노이즈에 영향과 잘못된 값을 읽어올 수 있음 
1. 온도와 같이 센서 자체 문제
2. 케이블의 신호 생성, 전송에서의 문제
3. 전기장치의 간섭
=> 잡음이 있는 신호가 생성됨

노이즈를 어떻게 해결?
